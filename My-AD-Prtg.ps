å¥½çš„ï¼Œè®“æˆ‘å€‘ä¾†è£œå……PowerShellå®‰è£Dockerçš„æŒ‡ä»¤ï¼Œä¸¦å°‡æ‰€æœ‰ç¨‹å¼ç¢¼é€²è¡Œæ¨¡çµ„åŒ–åˆä½µã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„æ¨¡çµ„åŒ–è…³æœ¬ï¼ŒåŒ…å«å®‰è£Dockerã€å»ºç«‹Dockerå®¹å™¨ã€å®‰è£AD Domain Controllerå’ŒPRTGï¼Œä¸¦è¨­å®šç›£æ§AD Domainå’ŒExchangeçš„æ•´é«”å¥åº·ç‹€æ…‹ã€‚

### æ­¥é©Ÿ 1: å®‰è£ Docker
é¦–å…ˆï¼Œä½¿ç”¨PowerShellå®‰è£Dockerï¼š

```powershell
# å®‰è£Docker
Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force
Install-Module -Name DockerMsftProvider -Force
Install-Package -Name docker -ProviderName DockerMsftProvider -Force
Restart-Computer -Force
```

### æ­¥é©Ÿ 2: å»ºç«‹ Dockerfile
æ¥ä¸‹ä¾†ï¼Œå»ºç«‹ä¸€å€‹Dockerfileä¾†å®šç¾©å®¹å™¨çš„é…ç½®ï¼š

```dockerfile
# ä½¿ç”¨Windows Server Coreä½œç‚ºåŸºç¤æ˜ åƒ
FROM mcr.microsoft.com/windows/servercore:ltsc2019

# å®‰è£AD Domain Controllerå’ŒPRTG
RUN powershell -Command `
    Install-WindowsFeature -Name AD-Domain-Services; `
    Install-WindowsFeature -Name RSAT-AD-AdminCenter; `
    Invoke-WebRequest -Uri "https://www.paessler.com/download/prtg-download" -OutFile "C:\\prtg.zip"; `
    Expand-Archive -Path "C:\\prtg.zip" -DestinationPath "C:\\prtg"; `
    Start-Process -FilePath "C:\\prtg\\setup.exe" -ArgumentList "/S" -Wait
```

### æ­¥é©Ÿ 3: ç·¨å¯« PowerShell è…³æœ¬
ä»¥ä¸‹æ˜¯æ¨¡çµ„åŒ–çš„PowerShellè…³æœ¬ï¼ŒåŒ…å«å®‰è£å’Œè¨­å®šçš„è©³ç´°æ­¥é©Ÿï¼š

```powershell
# å®šç¾©è®Šæ•¸
$domainName = "example.com"
$adminPassword = ConvertTo-SecureString "P@ssw0rd" -AsPlainText -Force
$prtgServer = "localhost"
$prtgUser = "admin"
$prtgPass = "prtgadmin"

# å®‰è£AD Domain Controller
function Install-ADDomainController {
    param (
        [string]$domainName,
        [SecureString]$adminPassword
    )
    Install-ADDSForest -DomainName $domainName -SafeModeAdministratorPassword $adminPassword
}

# å®‰è£ä¸¦è¨­å®šPRTG
function Install-PRTG {
    Start-Process -FilePath "C:\\prtg\\setup.exe" -ArgumentList "/S" -Wait
}

# è¨­å®šPRTGç›£æ§AD Domainå’ŒExchange
function Configure-PRTG {
    param (
        [string]$prtgServer,
        [string]$prtgUser,
        [string]$prtgPass
    )
    $prtgSession = New-PrtgSession -Server $prtgServer -Username $prtgUser -Password $prtgPass
    Add-PrtgSensor -Session $prtgSession -Device "AD Domain Controller" -SensorType "Active Directory"
    Add-PrtgSensor -Session $prtgSession -Device "Exchange Server" -SensorType "Exchange Server"
}

# æŸ¥é©—æ•´é«”å¥åº·ç‹€æ…‹çš„æŒ‡ä»¤
function Check-HealthStatus {
    param (
        [string]$prtgServer,
        [string]$prtgUser,
        [string]$prtgPass
    )
    $prtgSession = New-PrtgSession -Server $prtgServer -Username $prtgUser -Password $prtgPass
    Get-PrtgSensor -Session $prtgSession -Device "AD Domain Controller"
    Get-PrtgSensor -Session $prtgSession -Device "Exchange Server"
}

# åŸ·è¡Œå®‰è£å’Œè¨­å®š
Install-ADDomainController -domainName $domainName -adminPassword $adminPassword
Install-PRTG
Configure-PRTG -prtgServer $prtgServer -prtgUser $prtgUser -prtgPass $prtgPass
Check-HealthStatus -prtgServer $prtgServer -prtgUser $prtgUser -prtgPass $prtgPass
```

### æ­¥é©Ÿ 4: å»ºç«‹ Docker æ˜ åƒ
ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¾†å»ºç«‹Dockeræ˜ åƒï¼š

```bash
docker build -t my-ad-prtg .
```

### æ­¥é©Ÿ 5: åŸ·è¡Œ Docker å®¹å™¨
ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¾†åŸ·è¡ŒDockerå®¹å™¨ï¼š

```bash
docker run -d --name my-ad-prtg my-ad-prtg
```

### æ­¥é©Ÿ 6: ä¸Šå‚³åˆ° GitHub
æœ€å¾Œï¼Œå°‡ä½ çš„è…³æœ¬å’ŒDockerfileä¸Šå‚³åˆ°GitHubã€‚ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
git init
git add .
git commit -m "Initial commit"
git remote add origin https://github.com/yourusername/yourrepository.git
git push -u origin master
```

é€™æ¨£ä½ å°±å®Œæˆäº†ï¼å¦‚æœä½ æœ‰ä»»ä½•å•é¡Œæˆ–éœ€è¦é€²ä¸€æ­¥çš„å¹«åŠ©ï¼Œéš¨æ™‚å‘Šè¨´æˆ‘ã€‚ğŸ˜Š
